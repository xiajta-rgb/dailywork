- name: 执行GitHub趋势数据爬取
  env:
    ADMIN_USERNAME: ${{ secrets.ADMIN_USERNAME }}
    ADMIN_PASSWORD: ${{ secrets.ADMIN_PASSWORD }}
    BASE_URL: "https://trend.pythonanywhere.com"
  run: |
    # 1. 先确认脚本文件存在（打印文件列表）
    echo "===== 检查脚本文件 ====="
    ls -la trend_crawler.py || echo "❌ trend_crawler.py 文件不存在！"
    
    # 2. 先创建日志目录
    mkdir -p logs
    
    # 3. 执行脚本（实时打印所有报错，同时保存日志）
    echo "===== 开始执行脚本 ====="
    python trend_crawler.py 2>&1 | tee logs/crawl_log_$(date +%Y%m%d_%H%M%S).log
    
    # 4. 打印退出码（确认脚本返回的错误码）
    echo "===== 脚本退出码 ====="
    echo $?
